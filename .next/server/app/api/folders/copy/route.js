(()=>{var e={};e.id=6407,e.ids=[6407],e.modules={1690:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>m,routeModule:()=>u,serverHooks:()=>y,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>f});var s={};t.r(s),t.d(s,{POST:()=>p});var o=t(96559),i=t(48088),n=t(37719),a=t(32190);let l=(0,t(23607).UU)("https://kegskzgwkhltieyddbby.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{persistSession:!1}});async function d(e,r,t){try{let{data:s,error:o}=await l.from("folders").select("*").eq("id",e).single();if(o||!s)return console.error("Error fetching folder:",o),null;let i=`${s.name} (copy)`,{data:n,error:a}=await l.from("folders").insert({name:i,dimension_id:t,parent_folder_id:r||null}).select().single();if(a||!n)return console.error("Error creating new folder:",a),null;let{data:p,error:u}=await l.from("files").select("*").eq("folder_id",e);if(!u&&p&&p.length>0){let e=p.map(e=>({name:e.name,file_path:e.file_path,file_type:e.file_type,file_size:e.file_size,dimension_id:t,folder_id:n.id,uploaded_by:e.uploaded_by,public_url:e.public_url})),{error:r}=await l.from("files").insert(e);r&&console.error("Error copying files:",r)}let{data:c,error:f}=await l.from("folders").select("*").eq("parent_folder_id",e);if(!f&&c&&c.length>0)for(let e of c)await d(e.id,n.id,t);return n.id}catch(e){return console.error("Error in copyFolderRecursive:",e),null}}async function p(e){try{let{folderId:r,targetParentFolderId:t,dimensionId:s}=await e.json();if(!r||!s)return a.NextResponse.json({error:"Missing required fields"},{status:400});let o=await d(r,t||null,s);if(!o)return a.NextResponse.json({error:"Failed to copy folder"},{status:500});return a.NextResponse.json({success:!0,folderId:o})}catch(e){return console.error("Error copying folder:",e),a.NextResponse.json({error:e.message||"An unexpected error occurred"},{status:500})}}let u=new o.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/folders/copy/route",pathname:"/api/folders/copy",filename:"route",bundlePath:"app/api/folders/copy/route"},resolvedPagePath:"C:\\Users\\Jave\\Desktop\\research\\esbmexico\\src\\app\\api\\folders\\copy\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:c,workUnitAsyncStorage:f,serverHooks:y}=u;function m(){return(0,n.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:f})}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[7719,3607,580],()=>t(1690));module.exports=s})();