(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[502],{2523:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var a=s(5155),r=s(2115),l=s(6707);let n=r.forwardRef((e,t)=>{let{className:s,type:r,...n}=e;return(0,a.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});n.displayName="Input"},2623:(e,t,s)=>{"use strict";s.d(t,{ContentTable:()=>T});var a=s(5155),r=s(2115),l=s(5695),n=s(4416),i=s(1492),o=s(9869),d=s(852),c=s(4020),m=s(1788),x=s(4357),h=s(9496),u=s(6683),p=s(3717),g=s(2525),f=s(285),y=s(4838),j=s(6842),b=s(3704),k=s(8437),N=s(8472),v=s(1448),w=s(4218),C=s(4990),S=s(6766),A=s(8033);function I(e){let{files:t,currentFolderId:s,dimensionId:n,isSharedView:i=!1,currentAdminRole:o}=e,{isMasterAdmin:d,isDimensionLeader:I,isDimensionMember:P,assignedDimensionId:F}=(0,k.A)(),_=(0,l.useRouter)(),[T,L]=(0,r.useState)(null),[R,E]=(0,r.useState)(null),[O,D]=(0,r.useState)(null),{addDownload:M,updateDownload:U}=(0,v.m)(),{moveItem:z,setMoveItem:J}=(0,w.a)(),[B,q]=(0,r.useState)(!1),Z=e=>{switch(null==e?void 0:e.toLowerCase()){case"pdf":return(0,a.jsx)(S.default,{src:"/images/icons/pdf.svg",alt:"PDF Icon",className:"w-10 h-10",width:10,height:10});case"docx":return(0,a.jsx)(S.default,{src:"/images/icons/doc-icon.svg",alt:"DOCX Icon",className:"w-7 h-7",width:7,height:7});case"pptx":return(0,a.jsx)(S.default,{src:"/images/icons/ppt-icon.svg",alt:"PPTX Icon",className:"w-10 h-10",width:10,height:10});case"xlsx":return(0,a.jsx)(S.default,{src:"/images/icons/excel-icon.svg",alt:"XLSX Icon",className:"w-10 h-10",width:10,height:10});case"txt":return(0,a.jsx)(S.default,{src:"/images/icons/txt-icon.svg",alt:"TXT Icon",className:"w-10 h-10",width:10,height:10});default:return(0,a.jsx)(S.default,{src:"/images/icons/txt-icon.svg",alt:"Default Icon",className:"w-10 h-10",width:10,height:10})}},$=e=>{J({type:"file",id:e.id,name:e.name,currentFolderId:e.folder_id||null})},G=async e=>{try{let t=await fetch("/api/files/copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileId:e.id,targetFolderId:s||null})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to copy file")}_.refresh()}catch(e){console.error("Error copying file:",e),alert("Error copying file: ".concat(e.message))}},X=async e=>{let t=M({name:e.name,type:"file"});try{U(t,{status:"downloading",progress:10}),U(t,{progress:30});let s=await fetch("/api/files/download?path=".concat(encodeURIComponent(e.file_path)));if(!s.ok)throw Error("Failed to download file");U(t,{progress:70});let a=await s.blob(),r=URL.createObjectURL(a),l=document.createElement("a");l.href=r,l.download=e.name,document.body.appendChild(l),l.click(),URL.revokeObjectURL(r),document.body.removeChild(l),U(t,{status:"completed",progress:100})}catch(e){console.error("Error downloading file:",e),U(t,{status:"error",error:e instanceof Error?e.message:"Download failed"})}};return 0===t.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[(0,a.jsx)(S.default,{src:"/images/no-files.svg",alt:"No folders",width:400,height:400,className:"mb-6"}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"Current directory have no files."}),(0,a.jsx)("p",{className:"text-gray-400 dark:text-gray-500",children:'Click the "Upload File" button at the top right to add files in this directory.'})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-white/5 dark:bg-white/3",children:(0,a.jsx)("div",{className:"max-w-full overflow-x-auto",children:(0,a.jsx)("div",{className:"min-w-[1102px]",children:(0,a.jsxs)(j.XI,{children:[(0,a.jsx)(j.A0,{className:"border-b border-gray-100 dark:border-white/5",children:(0,a.jsxs)(j.Hj,{children:[(0,a.jsx)(j.nA,{className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Document"}),(0,a.jsx)(j.nA,{className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Dimension"}),(0,a.jsx)(j.nA,{className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Size"}),(0,a.jsx)(j.nA,{className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Status"}),(0,a.jsx)(j.nA,{className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Upload Date"}),(0,a.jsx)(j.nA,{className:"px-5 py-3 font-medium text-gray-500 text-center text-theme-xs dark:text-gray-400",children:"Actions"})]})}),(0,a.jsx)(j.BF,{className:"divide-y divide-gray-100 dark:divide-white/5",children:t.map(e=>{var t,s;return(0,a.jsxs)(j.Hj,{children:[(0,a.jsx)(j.nA,{className:"px-5 py-4 sm:px-6 text-start",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 flex items-center",children:Z(null==e?void 0:e.name.split(".").pop())}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"block font-medium text-gray-800 text-theme-sm dark:text-white/90",children:e.name}),(0,a.jsx)("span",{className:"block text-gray-500 text-theme-xs dark:text-gray-400",children:(null==(t=e.folder)?void 0:t.name)||"-"})]})]})}),(0,a.jsx)(j.nA,{className:"px-4 py-3 text-gray-500 text-start text-theme-sm dark:text-gray-400",children:(null==(s=e.dimension)?void 0:s.name)||"-"}),(0,a.jsx)(j.nA,{className:"px-4 py-3 text-gray-500 text-start text-theme-sm dark:text-gray-400",children:e.file_size?"".concat(Math.round(e.file_size/1024)," KB"):"-"}),(0,a.jsx)(j.nA,{className:"px-4 py-3 text-gray-500 text-start text-theme-sm dark:text-gray-400",children:(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)(C.A,{className:"draft"===e.status?"bg-blue-100 text-blue-800 dark:bg-blue-900":"for_checking"===e.status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900":"checked"===e.status?"bg-green-100 text-green-800 dark:bg-green-900":"bg-purple-100 text-purple-800 dark:bg-purple-900",children:"for_checking"===e.status?"For Checking":e.status.charAt(0).toUpperCase()+e.status.slice(1)})})}),(0,a.jsx)(j.nA,{className:"px-4 py-3 text-gray-500 text-start text-theme-sm dark:text-gray-400",children:new Date(e.created_at).toLocaleString()}),(0,a.jsx)(j.nA,{className:"px-4 py-3 text-gray-500 text-theme-sm dark:text-gray-400",children:(0,a.jsxs)(y.rI,{children:[(0,a.jsx)(y.ty,{asChild:!0,children:(0,a.jsxs)(f.$,{variant:"ghost",size:"icon",className:"text-black dark:text-white hover:bg-gray-200 rounded-xl dark:hover:bg-gray-400",children:[(0,a.jsx)(c.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Actions"})]})}),(0,a.jsxs)(y.SQ,{align:"end",className:"py-4 px-6",children:[(0,a.jsxs)(y._2,{onClick:()=>X(e),className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Download"]}),(5===o&&("draft"===e.status||"revisions"===e.status)||5!==o)&&(0,a.jsxs)(y._2,{onClick:()=>G(e),className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Make a copy"]}),(5===o&&("draft"===e.status||"revisions"===e.status)||5!==o)&&(0,a.jsxs)(y._2,{onClick:()=>$(e),className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Move"]}),(5===o&&("draft"===e.status||"revisions"===e.status)||5!==o)&&(0,a.jsxs)(y._2,{onClick:()=>L(e),className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Share"]}),(5===o&&("draft"===e.status||"revisions"===e.status)||5!==o)&&(0,a.jsxs)(y._2,{onClick:()=>E(e),className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Rename"]}),(5===o&&("draft"===e.status||"revisions"===e.status)||5!==o)&&(0,a.jsxs)(y._2,{onClick:()=>D(e),className:"text-destructive relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})})]},e.id)})})]})})})}),R&&(0,a.jsx)(A.A,{isOpen:!!R,onClose:()=>E(null),itemType:"file",itemId:R.id,currentName:R.name,onSuccess:()=>{_.refresh()}}),O&&(0,a.jsx)(b.A,{isOpen:!!O,onClose:()=>D(null),itemType:"file",itemId:O.id,itemName:O.name,onSuccess:()=>{_.refresh()}}),T&&(0,a.jsx)(N.Z,{isOpen:!!T,onClose:()=>L(null),itemType:"file",itemId:T.id,itemName:T.name,currentDimensionId:T.dimension_id,onSuccess:()=>{_.refresh()}})]})}var P=s(2407),F=s(858),_=s(6773);function T(e){let{folders:t,files:s,dimensionId:c,dimensionSlug:m,currentFolderId:x,currentlyFolder:h,isSharedView:u=!1,currentAdminRole:p,hasAccessToThisDimension:g=!1}=e,f=(0,l.useRouter)(),[y,j]=(0,r.useState)(!1),[b,k]=(0,r.useState)(!1),[N,v]=(0,r.useState)(""),[C,S]=(0,r.useState)({field:"name",order:"asc"}),{moveItem:A,setMoveItem:T}=(0,w.a)(),[L,R]=(0,r.useState)(!1),[E,O]=(0,r.useState)(1),D=(null==h?void 0:h.status)||"draft";(0,r.useEffect)(()=>{O(1)},[N,C]);let M=(0,r.useMemo)(()=>N.trim()?s.filter(e=>e.name.toLowerCase().includes(N.toLowerCase())):s,[s,N]),U=(0,r.useMemo)(()=>{let e=[...M];switch(C.field){case"name":e.sort((e,t)=>e.name.localeCompare(t.name));break;case"type":e.sort((e,t)=>(e.file_type||"").localeCompare(t.file_type||""));break;case"size":e.sort((e,t)=>e.file_size-t.file_size);break;case"date":e.sort((e,t)=>new Date(e.created_at).getTime()-new Date(t.created_at).getTime())}return"desc"===C.order&&e.reverse(),e},[M,C]),z=Math.ceil(U.length/10),J=(0,r.useMemo)(()=>{let e=(E-1)*10;return U.slice(e,e+10)},[U,E]),B=async()=>{if(A&&"file"===A.type){R(!0);try{let e=await fetch("/api/files/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileId:A.id,targetFolderId:x||null})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to move file")}T(null),f.refresh()}catch(e){console.error("Error moving file:",e),alert("Error moving file: ".concat(e.message))}finally{R(!1)}}};return(0,r.useEffect)(()=>{let e=Math.ceil(U.length/10);O(t=>Math.min(t,Math.max(e,1)))},[U]),(0,a.jsxs)("div",{className:"space-y-6",children:[A&&(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg p-4 flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:"text-sm font-medium",children:["Moving ",A.type,": ",(0,a.jsx)("span",{className:"font-semibold",children:A.name})]})}),(0,a.jsx)(d.A,{onClick:()=>T(null),className:"h-6 w-6 p-0 flex items-center justify-center",children:(0,a.jsx)(n.A,{className:"h-4 w-4 text-gray-700 dark:text-white"})})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("div",{className:"relative flex gap-4 mb-8 items-center justify-end",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute -translate-y-1/2 left-4 top-1/2 pointer-events-none",children:(0,a.jsx)("svg",{className:"fill-gray-500 dark:fill-gray-400",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.04175 9.37363C3.04175 5.87693 5.87711 3.04199 9.37508 3.04199C12.8731 3.04199 15.7084 5.87693 15.7084 9.37363C15.7084 12.8703 12.8731 15.7053 9.37508 15.7053C5.87711 15.7053 3.04175 12.8703 3.04175 9.37363ZM9.37508 1.54199C5.04902 1.54199 1.54175 5.04817 1.54175 9.37363C1.54175 13.6991 5.04902 17.2053 9.37508 17.2053C11.2674 17.2053 13.003 16.5344 14.357 15.4176L17.177 18.238C17.4699 18.5309 17.9448 18.5309 18.2377 18.238C18.5306 17.9451 18.5306 17.4703 18.2377 17.1774L15.418 14.3573C16.5365 13.0033 17.2084 11.2669 17.2084 9.37363C17.2084 5.04817 13.7011 1.54199 9.37508 1.54199Z",fill:""})})}),(0,a.jsx)("input",{type:"search",placeholder:"Search folders...",value:N,onChange:e=>v(e.target.value),className:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-200 bg-transparent py-2.5 pl-12 pr-14 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-white dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800 xl:w-[430px]"})]}),(0,a.jsxs)(d.A,{variant:"outline",onClick:()=>k(!0),className:"flex items-center gap-1",children:[(0,a.jsx)(i.A,{className:"h-4 w-4 mr-1"}),"Sort"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-medium text-black dark:text-white",children:"Files"}),(g&&5===p&&("draft"===D||"revisions"===D)||g&&5!==p)&&(0,a.jsxs)("div",{className:"flex gap-4",children:[A&&"file"===A.type&&(0,a.jsx)(d.A,{onClick:B,disabled:L,children:L?"Moving...":"Move here"}),(0,a.jsxs)(d.A,{onClick:()=>j(!0),children:[(0,a.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"Upload File"]})]})]})]}),(0,a.jsx)(I,{files:J,isSharedView:u,dimensionId:c,currentFolderId:x,currentAdminRole:p}),z>=1&&(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)(_.A,{currentPage:E,totalPages:z,onPageChange:e=>O(e)})}),(0,a.jsx)(P.r,{isOpen:y,onClose:()=>j(!1),dimensionId:c,currentFolderId:x,onSuccess:()=>f.refresh()}),(0,a.jsx)(F.X,{isOpen:b,onClose:()=>k(!1),options:C,onSort:S,title:"Sort Files",availableFields:["name","type","size","date"]})]})}},4165:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>m,Es:()=>h,L3:()=>u,c7:()=>x,lG:()=>o,rr:()=>p});var a=s(5155),r=s(2115),l=s(5452),n=s(4416),i=s(6707);let o=l.bL;l.l9;let d=l.ZL;l.bm;let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-9999999 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});c.displayName=l.hJ.displayName;let m=r.forwardRef((e,t)=>{let{className:s,children:r,...o}=e;return(0,a.jsxs)(d,{children:[(0,a.jsx)(c,{}),(0,a.jsxs)(l.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-9999999 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...o,children:[r,(0,a.jsxs)(l.bm,{className:"text-black dark:text-white absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=l.UC.displayName;let x=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};x.displayName="DialogHeader";let h=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};h.displayName="DialogFooter";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});u.displayName=l.hE.displayName;let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});p.displayName=l.VY.displayName},5127:(e,t,s)=>{"use strict";s.d(t,{A0:()=>i,BF:()=>o,Hj:()=>d,XI:()=>n,nA:()=>m,nd:()=>c});var a=s(5155),r=s(2115),l=s(6707);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,l.cn)("w-full caption-bottom text-sm",s),...r})})});n.displayName="Table";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:(0,l.cn)("[&_tr]:border-b",s),...r})});i.displayName="TableHeader";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,l.cn)("[&_tr:last-child]:border-0",s),...r})});o.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});d.displayName="TableRow";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("th",{ref:t,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r})});c.displayName="TableHead";let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("td",{ref:t,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r})});m.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption"},6733:(e,t,s)=>{"use strict";s.d(t,{ContentExplorer:()=>eh});var a=s(5155),r=s(2115),l=s(5695),n=s(6874),i=s.n(n),o=s(6695),d=s(4838),c=s(2919),m=s(4020),x=s(430),h=s(9530),u=s(646),p=s(3717),g=s(6683),f=s(1284),y=s(1788),j=s(4357),b=s(9496),k=s(2525),N=s(3704),v=s(8437),w=s(6766),C=s(8472),S=s(1448),A=s(4218),I=s(285),P=s(4165),F=s(5057);let _=e=>{let{id:t,placeholder:s="Enter your message...",rows:r=3,value:l="",onChange:n,className:i="",disabled:o=!1,error:d=!1,hint:c=""}=e,m="w-full rounded-lg border px-4 py-2.5 text-sm focus:outline-hidden resize-none transition-colors "+i;return o?m+=" bg-gray-100 opacity-50 text-gray-500 border-gray-300 cursor-not-allowed":d?m+=" bg-transparent text-gray-800 border-red-400 focus:border-red-500 focus:ring-1 focus:ring-red-500/40":m+=" bg-transparent text-gray-800 border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500/40",(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("textarea",{id:t,placeholder:s,rows:r,value:l,onChange:n,disabled:o,className:m}),c&&(0,a.jsx)("p",{className:"mt-2 text-xs ".concat(d?"text-red-600":"text-gray-500"),children:c})]})};var T=s(6958);function L(e){let{isOpen:t,onClose:s,itemType:n,itemId:i,itemName:o,dimensionId:d,onSuccess:c}=e,m=(0,l.useRouter)(),[x,h]=(0,r.useState)(""),[u,p]=(0,r.useState)(!1),[g,f]=(0,r.useState)(null),{showAlert:y}=(0,T.M)(),j=async()=>{if(!x.trim())return void f("Please provide a reason for revision");p(!0),f(null);try{let e=await fetch("/api/folders/request-revision",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({itemType:n,itemId:i,dimensionId:d,reason:x.trim()})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to request revision")}y({type:"success",title:"Request submited.",message:"Successfully requested revision."}),m.refresh(),c(),s(),h("")}catch(e){f(e.message||"Failed to request revision"),y({type:"error",title:"Request failed.",message:"Failed to request revision."})}finally{p(!1)}};return(0,a.jsx)(P.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(P.Cf,{className:"sm:max-w-md bg-white dark:bg-gray-800",children:[(0,a.jsxs)(P.c7,{children:[(0,a.jsx)(P.L3,{className:"text-black dark:text-white",children:"Request for Revision"}),(0,a.jsxs)(P.rr,{className:"text-black dark:text-white",children:["Request additional changes to ",n,": ",(0,a.jsx)("strong",{children:o})]})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[g&&(0,a.jsxs)("div",{className:"mt-2 flex items-start space-x-2 rounded-md bg-red-50 px-3 py-2 text-sm text-red-700 dark:bg-red-900/30 dark:text-red-300",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L4.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,a.jsx)("span",{children:g})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(F.J,{htmlFor:"reason",className:"text-black dark:text-white",children:"Reason for Revision"}),(0,a.jsx)(_,{id:"reason",placeholder:"Describe what additional changes you need...",rows:4,value:x,onChange:e=>h(e.target.value),error:!!g,className:"text-black dark:text-white",hint:g||"Your revision request will be sent to the dimension leader for approval."})]})]}),(0,a.jsxs)(P.Es,{children:[(0,a.jsx)(I.$,{variant:"outline",className:"text-black dark:text-white",onClick:s,children:"Cancel"}),(0,a.jsx)(I.$,{className:"text-black dark:text-white",onClick:j,disabled:u||!x.trim(),children:u?"Submitting...":"Submit Request"})]})]})})}var R=s(9409);let E=[{value:"draft",label:"Draft",color:"bg-blue-100"},{value:"for_checking",label:"For Checking",color:"bg-yellow-100"},{value:"checked",label:"Checked",color:"bg-green-100"},{value:"revisions",label:"Revisions",color:"bg-purple-100"}];function O(e){let{isOpen:t,onClose:s,folderId:n,currentStatus:i,folderName:o,isDimensionLeader:d,isDimensionMember:c,onSuccess:m}=e,x=(0,l.useRouter)(),[h,u]=(0,r.useState)(i),[p,g]=(0,r.useState)(!0),[f,y]=(0,r.useState)(!1),[j,b]=(0,r.useState)(null),{showAlert:k}=(0,T.M)(),N=async()=>{y(!0),b(null);try{let e=await fetch("/api/folders/update-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderId:n,newStatus:h})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to update folder status")}k({type:"success",title:"Update successful.",message:"Folder status updated successfully."}),x.refresh(),m(),s()}catch(e){b(e.message||"Failed to update folder status"),k({type:"success",title:"Update failed.",message:"Failed to update folder status."})}finally{y(!1)}},v=(()=>{if(c){if(c){if("draft"===i)return["draft","for_checking"];if("revisions"===i)return["revisions"]}}else{if("draft"===i)return["draft","for_checking"];if("for_checking"===i)return["for_checking","checked"];if("checked"===i)return["checked","revisions"];if("revisions"===i)return["revisions","checked"]}return[i]})();return(0,a.jsx)(P.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(P.Cf,{className:"sm:max-w-md bg-white dark:bg-gray-800",children:[(0,a.jsxs)(P.c7,{children:[(0,a.jsx)(P.L3,{className:"text-black dark:text-white",children:"Change Folder Status"}),(0,a.jsxs)(P.rr,{className:"text-black dark:text-white",children:["Update the status of folder ",(0,a.jsx)("strong",{children:o})]})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[j&&(0,a.jsx)("div",{className:"text-sm text-red-600",children:j}),(0,a.jsxs)("div",{children:[(0,a.jsx)(F.J,{htmlFor:"status",className:"text-black dark:text-white",children:"New Status"}),(0,a.jsxs)(R.l6,{value:h,onValueChange:e=>u(e),disabled:v.length<=1,children:[(0,a.jsx)(R.bq,{id:"status",className:"text-black dark:text-white",children:(0,a.jsx)(R.yv,{placeholder:"Select a status"})}),(0,a.jsx)(R.gC,{className:"text-black dark:text-white bg-white dark:bg-gray-950",children:v.map(e=>{let t=E.find(t=>t.value===e);return(0,a.jsx)(R.eb,{value:e,children:null==t?void 0:t.label},e)})})]})]}),(0,a.jsx)("div",{className:"flex items-center justify-center gap-2",children:(0,a.jsx)(F.J,{htmlFor:"cascade",className:"text-sm font-normal cursor-pointer text-black dark:text-white text-center border border-green-900 bg-green-100 dark:bg-green-900 py-4 px-4 rounded-2xl",children:"Status applied to all nested folders and files"})}),(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded p-3 text-sm",children:[(0,a.jsx)("p",{className:"font-medium mb-2 text-black dark:text-white",children:"Status Information:"}),(0,a.jsxs)("ul",{className:"space-y-1 text-xs text-black dark:text-white",children:[(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"Draft:"})," Members can upload, delete, rename, and other actions"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"For Checking:"})," Members cannot perform actions (read-only pending review)"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"Checked:"})," Members can only download and request revision"]}),(0,a.jsxs)("li",{children:["• ",(0,a.jsx)("strong",{children:"Revisions:"})," Members can perform actions again"]})]})]})]}),(0,a.jsxs)(P.Es,{children:[(0,a.jsx)(I.$,{variant:"outline",onClick:s,children:"Cancel"}),(0,a.jsx)(I.$,{onClick:N,disabled:f||v.length<=1,children:f?"Updating...":"Update Status"})]})]})})}var D=s(4990),M=s(852),U=s(2523),z=s(1243);function J(e){let{isOpen:t,onClose:s,folderId:n,folderName:i,onSuccess:o}=e,d=(0,l.useRouter)(),[c,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),[u,p]=(0,r.useState)(""),[g,f]=(0,r.useState)(!1),[y,j]=(0,r.useState)(null),{showAlert:b}=(0,T.M)(),k=async()=>{if(!c.trim()||!x.trim())return void j("Please enter and confirm a new PIN");if(!/^\d{6}$/.test(c))return void j("PIN must be exactly 6 digits");if(c!==x)return void j("PINs do not match");f(!0),j(null);try{let e=await fetch("/api/folders/reset-pin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderId:n,newPin:c,reason:u})}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to reset PIN");b({type:"success",title:"PIN Reset.",message:"Folder PIN reset successful."}),o(),s(),d.refresh()}catch(e){j(e.message||"Failed to reset PIN"),b({type:"error",title:"PIN Reset.",message:"Failed to reset PIN."})}finally{f(!1)}},N=e=>e.replace(/\D/g,"").slice(0,6);return(0,a.jsx)(P.lG,{open:t,onOpenChange:e=>{e||(m(""),h(""),p(""),j(null),s())},children:(0,a.jsxs)(P.Cf,{className:"sm:max-w-md bg-white dark:bg-gray-950",children:[(0,a.jsxs)(P.c7,{children:[(0,a.jsxs)(P.L3,{className:"flex items-center gap-2 text-amber-600",children:[(0,a.jsx)(z.A,{className:"h-5 w-5 text-black dark:text-white"}),"Reset Folder PIN"]}),(0,a.jsxs)(P.rr,{className:"text-black dark:text-white",children:['You are about to reset the PIN for "',i,'". This action will clear all active unlock tokens.']})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded p-3 text-sm text-amber-800",children:[(0,a.jsx)("p",{className:"font-medium mb-1",children:"Warning:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[(0,a.jsx)("li",{children:"All users with active unlock tokens will be locked out"}),(0,a.jsx)("li",{children:"Users will need to enter the new PIN to regain access"}),(0,a.jsx)("li",{children:"This action is logged for audit purposes"})]})]}),(0,a.jsxs)("div",{className:"space-y-2 text-black dark:text-white",children:[(0,a.jsx)(F.J,{htmlFor:"new-pin text-black dark:text-white",children:"New 6-Digit PIN"}),(0,a.jsx)(U.p,{id:"new-pin",type:"password",value:c,onChange:e=>{m(N(e.target.value)),j(null)},placeholder:"000000",maxLength:6,className:"tracking-widest text-center text-lg text-black dark:text-white",inputMode:"numeric"})]}),(0,a.jsxs)("div",{className:"space-y-2 text-black dark:text-white",children:[(0,a.jsx)(F.J,{htmlFor:"confirm-pin",children:"Confirm PIN"}),(0,a.jsx)(U.p,{id:"confirm-pin",type:"password",value:x,onChange:e=>{h(N(e.target.value)),j(null)},placeholder:"000000",maxLength:6,className:"tracking-widest text-center text-lg text-black dark:text-white",inputMode:"numeric"})]}),(0,a.jsxs)("div",{className:"space-y-2 text-black dark:text-white",children:[(0,a.jsx)(F.J,{htmlFor:"reason",children:"Reason for Reset"}),(0,a.jsx)(_,{id:"reason",value:u,onChange:e=>p(e.target.value),placeholder:"e.g., User forgot PIN, security breach, etc.",className:"text-sm resize-none text-black dark:text-white",rows:3})]}),y&&(0,a.jsx)("div",{className:"text-sm text-destructive bg-destructive/10 p-2 rounded",children:y})]}),(0,a.jsxs)(P.Es,{className:"flex items-center",children:[(0,a.jsx)(I.$,{variant:"outline",onClick:s,disabled:g,className:"text-black dark:text-white",children:"Cancel"}),(0,a.jsx)(M.A,{onClick:k,disabled:g||!c||!x,children:g?"Resetting...":"Reset PIN"})]})]})})}var B=s(8274),q=s(9114);function Z(e){let{isOpen:t,onClose:s,folderId:n,folderName:i,onSuccess:o,onForgotPin:d}=e,c=(0,l.useRouter)(),[m,h]=r.useState(Array(6).fill("")),[u,p]=r.useState(!1),[g,f]=r.useState(null),[y,j]=r.useState(0),[b,k]=r.useState(!1),N=y>=5,{showAlert:v}=(0,T.M)();r.useEffect(()=>{t||(h(Array(6).fill("")),f(null),j(0))},[t]);let w=()=>{k(!0),setTimeout(()=>k(!1),600)},C=m.join(""),S=async()=>{if(6!==C.length){f("PIN must be exactly 6 digits"),w();return}p(!0),f(null);try{let e=await fetch("/api/folders/unlock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderId:n,pin:C})}),t=await e.json();if(!e.ok){let e=y+1;j(e),w(),e>=5?f("Too many failed attempts. Please try again later."):f("".concat(t.error||"Invalid PIN",". Attempts remaining: ").concat(5-e));return}o(t.token),v({type:"success",title:"Folder unlocked.",message:"Folder unlocked successfully."}),s(),c.refresh()}catch(e){f(e.message||"Failed to unlock folder"),w()}finally{p(!1)}},A=(e,t)=>{let s=e.replace(/\D/g,"").slice(-1);if((s||""===e)&&(h(e=>{let a=[...e];return a[t]=s,a}),s)){let e=document.getElementById("otp-".concat(t+1));e&&e.focus()}},_=(e,t)=>{var s,a;if("Backspace"===e.key)if(""===m[t]){let e=document.getElementById("otp-".concat(t-1));e&&(e.focus(),h(e=>{let s=[...e];return s[t-1]="",s}))}else h(e=>{let s=[...e];return s[t]="",s});"ArrowLeft"===e.key&&t>0&&(null==(s=document.getElementById("otp-".concat(t-1)))||s.focus()),"ArrowRight"===e.key&&t<5&&(null==(a=document.getElementById("otp-".concat(t+1)))||a.focus())};return(0,a.jsx)(P.lG,{open:t,onOpenChange:e=>{e||(h(Array(6).fill("")),f(null),s())},children:(0,a.jsxs)(P.Cf,{className:"sm:max-w-md backdrop-blur-xl bg-white/80 dark:bg-gray-900/70 border border-gray-200/30 dark:border-gray-800/30 shadow-xl",children:[(0,a.jsxs)(P.c7,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"h-5 w-5"}),(0,a.jsx)(P.L3,{children:"Unlock Folder"})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:["Enter the 6-digit PIN to unlock ",(0,a.jsxs)("strong",{children:["“",i,"”"]}),"."]})]}),(0,a.jsxs)("div",{className:"py-4 space-y-4",children:[(0,a.jsx)(F.J,{className:"text-black dark:text-white",children:"6-Digit PIN"}),(0,a.jsx)(B.P.div,{animate:b?{x:[-8,8,-8,8,0]}:{},transition:{duration:.45},className:"flex justify-center gap-3",children:m.map((e,t)=>(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{id:"otp-".concat(t),type:"text",inputMode:"numeric",maxLength:1,value:e,disabled:N,onChange:e=>A(e.target.value,t),onKeyDown:e=>_(e,t),className:"w-12 h-14 rounded-xl border border-gray-300/60 dark:border-gray-700/50   bg-white/80 dark:bg-gray-800/70 text-xl font-semibold text-center   focus-visible:ring-2 focus-visible:ring-blue-500 shadow-sm   text-transparent caret-transparent selection:bg-transparent relative",style:{caretColor:"transparent"}}),(0,a.jsx)(q.N,{children:e&&(0,a.jsx)(B.P.span,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:"pointer-events-none absolute inset-0 flex items-center justify-center text-3xl text-black dark:text-white",children:"•"},"dot-".concat(t))})]},t))}),g&&(0,a.jsx)("div",{className:"text-sm p-2 rounded ".concat(N?"bg-red-100 text-red-700":"bg-red-50 text-red-600"),children:g}),!N&&(0,a.jsxs)("div",{className:"bg-blue-50/80 dark:bg-blue-900/30 border border-blue-200/40 dark:border-blue-800/30 rounded p-3 text-sm text-blue-800 dark:text-blue-300",children:[(0,a.jsx)("div",{className:"font-medium",children:"Session valid for 24 hours"}),(0,a.jsx)("div",{className:"text-xs opacity-90",children:"Once you unlock this folder, you won’t need to re-enter the PIN until your session expires."})]})]}),(0,a.jsxs)(P.Es,{className:"flex items-center justify-end gap-3",children:[(0,a.jsx)(I.$,{variant:"outline",onClick:s,disabled:u||N,className:"text-black dark:text-white",children:"Cancel"}),(0,a.jsx)(M.A,{onClick:S,disabled:u||6!==C.length||N,children:u?"Unlocking...":"Unlock Folder"})]})]})})}function $(e){let{isOpen:t,onClose:s,folderId:n,folderName:i,onSuccess:o}=e,d=(0,l.useRouter)(),[m,x]=(0,r.useState)(""),[h,u]=(0,r.useState)(""),[p,g]=(0,r.useState)(!1),[f,y]=(0,r.useState)(null),{showAlert:j}=(0,T.M)(),b=async()=>{if(!m.trim()||!h.trim())return void y("Please enter and confirm a PIN");if(!/^\d{6}$/.test(m))return void y("PIN must be exactly 6 digits");if(m!==h)return void y("PINs do not match");g(!0),y(null);try{let e=await fetch("/api/folders/lock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderId:n,pin:m})}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to lock folder");j({type:"success",title:"Folder locked.",message:"Folder locked successfully."}),o(),s(),d.refresh()}catch(e){y(e.message||"Failed to lock folder"),j({type:"error",title:"Failed.",message:"Failed to lock folder"})}finally{g(!1)}},k=e=>e.replace(/\D/g,"").slice(0,6);return(0,a.jsx)(P.lG,{open:t,onOpenChange:e=>{e||(x(""),u(""),y(null),s())},children:(0,a.jsxs)(P.Cf,{className:"sm:max-w-md bg-white dark:bg-gray-950",children:[(0,a.jsxs)(P.c7,{children:[(0,a.jsxs)(P.L3,{className:"flex items-center gap-2 text-black dark:text-white",children:[(0,a.jsx)(c.A,{className:"h-5 w-5"}),"Lock Folder"]}),(0,a.jsxs)(P.rr,{className:"text-black dark:text-white",children:['Set a 6-digit PIN to lock "',i,'". Only users with the correct PIN can unlock it.']})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(F.J,{htmlFor:"pin text-black dark:text-white",children:"6-Digit PIN"}),(0,a.jsx)(U.p,{id:"pin",type:"password",value:m,onChange:e=>{x(k(e.target.value)),y(null)},placeholder:"000000",maxLength:6,className:"tracking-widest text-center text-lg text-black dark:text-white",inputMode:"numeric"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground text-black dark:text-white",children:"Use only numbers. This PIN will be used to unlock the folder."})]}),(0,a.jsxs)("div",{className:"space-y-2 text-black dark:text-white",children:[(0,a.jsx)(F.J,{htmlFor:"confirmPin",children:"Confirm PIN"}),(0,a.jsx)(U.p,{id:"confirmPin",type:"password",value:h,onChange:e=>{u(k(e.target.value)),y(null)},placeholder:"000000",maxLength:6,className:"tracking-widest text-center text-lg text-black dark:text-white",inputMode:"numeric"})]}),f&&(0,a.jsxs)("div",{className:"mt-2 flex items-start space-x-2 rounded-md bg-red-50 px-3 py-2 text-sm text-red-700 dark:bg-red-900/30 dark:text-red-300",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L4.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,a.jsx)("span",{children:f})]}),(0,a.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded p-3 text-sm text-amber-800",children:[(0,a.jsx)("p",{className:"font-medium mb-1",children:"Important:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[(0,a.jsx)("li",{children:"Remember your PIN - there is no recovery if you forget it"}),(0,a.jsx)("li",{children:"Master admins and overall focal persons can reset the PIN"}),(0,a.jsx)("li",{children:"The unlock token is valid for 1 hour"})]})]})]}),(0,a.jsxs)(P.Es,{className:"flex items-center",children:[(0,a.jsx)(I.$,{variant:"outline",onClick:s,disabled:p,className:"text-black dark:text-white",children:"Cancel"}),(0,a.jsx)(M.A,{onClick:b,disabled:p||!m||!h,children:p?"Locking...":"Lock Folder"})]})]})})}var G=s(5127),X=s(4616),H=s(1154),V=s(4109),W=s(7354),Y=s(2241),Q=s(7924);let K=e=>{let{label:t,checked:s,id:r,onChange:l,className:n="",disabled:i=!1}=e;return(0,a.jsxs)("label",{className:"flex items-center space-x-3 group cursor-pointer ".concat(i?"cursor-not-allowed opacity-60":""),children:[(0,a.jsxs)("div",{className:"relative w-5 h-5",children:[(0,a.jsx)("input",{id:r,type:"checkbox",className:"w-5 h-5 appearance-none cursor-pointer dark:border-gray-700 border border-gray-300 checked:border-transparent rounded-md checked:bg-brand-500 disabled:opacity-60 \n          ".concat(n),checked:s,onChange:e=>l(e.target.checked),disabled:i}),s&&(0,a.jsx)("svg",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 pointer-events-none",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:(0,a.jsx)("path",{d:"M11.6666 3.5L5.24992 9.91667L2.33325 7",stroke:"white",strokeWidth:"1.94437",strokeLinecap:"round",strokeLinejoin:"round"})}),i&&(0,a.jsx)("svg",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 pointer-events-none",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:(0,a.jsx)("path",{d:"M11.6666 3.5L5.24992 9.91667L2.33325 7",stroke:"#E4E7EC",strokeWidth:"2.33333",strokeLinecap:"round",strokeLinejoin:"round"})})]}),t&&(0,a.jsx)("span",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:t})]})};function ee(e){let{isOpen:t,onClose:s,folderId:l,dimensionId:n,onSuccess:i}=e,[o,d]=(0,r.useState)(""),[c,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(!1),[u,p]=(0,r.useState)([]),[g,f]=(0,r.useState)([]),[y,j]=(0,r.useState)(!1),[b,k]=(0,r.useState)(null),[N,v]=(0,r.useState)(""),w=(0,r.useCallback)(async()=>{try{let e=await fetch("/api/admins/list"),t=await e.json();if(e.ok){let e=t.admins.filter(e=>e.assigned_dimension_id===n&&4!==e.role_id);f(e)}}catch(e){console.error("Error fetching admins:",e)}},[n]);(0,r.useEffect)(()=>{t&&w()},[t,w]);let C=async()=>{if(!o.trim())return void k("Please enter a task title");j(!0),k(null);try{let e=await fetch("/api/tasks/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderId:l,dimensionId:n,title:o.trim(),description:c.trim()||null,assignedToAdmins:x?[]:u,assignedToEveryone:x})}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to create task");d(""),m(""),h(!1),p([]),i(),s()}catch(e){k(e.message||"Failed to create task")}finally{j(!1)}},S=e=>{p(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},A=(0,r.useMemo)(()=>{let e=N.toLowerCase();return g.filter(t=>{var s;return null==(s=t.full_name)?void 0:s.toLowerCase().includes(e)})},[N,g]);return(0,a.jsx)(P.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(P.Cf,{className:"sm:max-w-xl bg-white dark:bg-gray-950",children:[(0,a.jsxs)("div",{className:"px-2",children:[(0,a.jsx)("h4",{className:"mb-2 text-2xl font-semibold text-gray-800 dark:text-white/90",children:"Create New Task"}),(0,a.jsx)("p",{className:"mb-6 text-sm text-gray-500 dark:text-gray-400 lg:mb-7",children:"Create a task for this folder and assign it to team members"})]}),(0,a.jsxs)(P.c7,{className:"hidden",children:[(0,a.jsx)(P.L3,{children:"Create New Task"}),(0,a.jsx)(P.rr,{children:"Create a task for this folder and assign it to team members"})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[b&&(0,a.jsx)("div",{className:"text-sm text-destructive",children:b}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Y.A,{htmlFor:"title",children:"Task Title"}),(0,a.jsx)(W.A,{id:"title",value:o,onChange:e=>{d(e.target.value),k(null)},placeholder:"Enter task title"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Y.A,{htmlFor:"description",children:"Description (Optional)"}),(0,a.jsx)(_,{id:"description",value:c,onChange:e=>m(e.target.value),placeholder:"Enter task description",rows:3})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(Y.A,{children:"Assign To"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(K,{id:"everyone",checked:x,onChange:e=>{h(e),e&&p([])}}),(0,a.jsx)(Y.A,{htmlFor:"everyone",className:"text-sm font-normal cursor-pointer",children:"Assign to Everyone"})]}),!x&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(Q.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),(0,a.jsx)(W.A,{type:"text",placeholder:"Search by name...",value:N,onChange:e=>v(e.target.value),className:"pl-9"})]}),(0,a.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto border rounded-md p-3",children:0===A.length?(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No matching members found"}):A.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(K,{id:"admin-".concat(e.id),checked:u.includes(e.id),onChange:()=>S(e.id)}),(0,a.jsx)(Y.A,{htmlFor:"admin-".concat(e.id),className:"text-sm font-normal cursor-pointer flex-1",children:e.full_name||"Unnamed Member"})]},e.id))})]})]})]}),(0,a.jsxs)(P.Es,{className:"flex items-center",children:[(0,a.jsx)(I.$,{variant:"outline",onClick:s,disabled:y,children:"Cancel"}),(0,a.jsx)(M.A,{onClick:C,disabled:y,children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(H.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Task"})]})]})})}function et(e){let{isOpen:t,onClose:s,onConfirm:r,isLoading:l}=e;return(0,a.jsx)(P.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(P.Cf,{className:"max-w-[480px] text-center z-99999999 p-8 bg-white dark:bg-gray-700",children:[(0,a.jsxs)("div",{className:"relative flex items-center justify-center my-7",children:[(0,a.jsx)("svg",{className:"fill-error-50 dark:fill-error-500/15",width:"90",height:"90",viewBox:"0 0 90 90",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{d:"M34.364 6.85053C38.6205 -2.28351 51.3795 -2.28351 55.636 6.85053C58.0129 11.951 63.5594 14.6722 68.9556 13.3853C78.6192 11.0807 86.5743 21.2433 82.2185 30.3287C79.7862 35.402 81.1561 41.5165 85.5082 45.0122C93.3019 51.2725 90.4628 63.9451 80.7747 66.1403C75.3648 67.3661 71.5265 72.2695 71.5572 77.9156C71.6123 88.0265 60.1169 93.6664 52.3918 87.3184C48.0781 83.7737 41.9219 83.7737 37.6082 87.3184C29.8831 93.6664 18.3877 88.0266 18.4428 77.9156C18.4735 72.2695 14.6352 67.3661 9.22531 66.1403C-0.462787 63.9451 -3.30193 51.2725 4.49185 45.0122C8.84391 41.5165 10.2138 35.402 7.78151 30.3287C3.42572 21.2433 11.3808 11.0807 21.0444 13.3853C26.4406 14.6722 31.9871 11.951 34.364 6.85053Z"})}),(0,a.jsx)("span",{className:"absolute -translate-x-1/2 -translate-y-1/2 left-1/2 top-1/2",children:(0,a.jsx)("svg",{className:"fill-error-600 dark:fill-error-500",width:"38",height:"38",viewBox:"0 0 38 38",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.62684 11.7496C9.04105 11.1638 9.04105 10.2141 9.62684 9.6283C10.2126 9.04252 11.1624 9.04252 11.7482 9.6283L18.9985 16.8786L26.2485 9.62851C26.8343 9.04273 27.7841 9.04273 28.3699 9.62851C28.9556 10.2143 28.9556 11.164 28.3699 11.7498L21.1198 18.9999L28.3699 26.25C28.9556 26.8358 28.9556 27.7855 28.3699 28.3713C27.7841 28.9571 26.8343 28.9571 26.2485 28.3713L18.9985 21.1212L11.7482 28.3715C11.1624 28.9573 10.2126 28.9573 9.62684 28.3715C9.04105 27.7857 9.04105 26.836 9.62684 26.2502L16.8771 18.9999L9.62684 11.7496Z"})})})]}),(0,a.jsxs)(P.c7,{className:"flex items-center",children:[(0,a.jsx)(P.L3,{className:"text-2xl font-semibold text-gray-800 dark:text-white/90",children:"DELETE Task"}),(0,a.jsx)(P.rr,{className:"text-sm text-center text-gray-500 dark:text-gray-400 mt-2",children:"This action cannot be undone. The task will be removed permanently."})]}),(0,a.jsxs)("div",{className:"flex justify-center gap-3 mt-8",children:[(0,a.jsx)(M.A,{size:"sm",variant:"outline",onClick:s,children:"Cancel"}),(0,a.jsx)(M.A,{size:"sm",onClick:r,disabled:l,children:l?"Deleting...":"Confirm Delete"})]})]})})}function es(e){let{isOpen:t,onClose:s,folderId:n,dimensionId:i,folderName:o,isDimensionMember:c}=e,x=(0,l.useRouter)(),[h,p]=(0,r.useState)([]),[g,f]=(0,r.useState)([]),[y,j]=(0,r.useState)(!1),[b,N]=(0,r.useState)(!1),[v,w]=(0,r.useState)(null),[C,S]=(0,r.useState)(null),[A,F]=(0,r.useState)(!1),[_,L]=(0,r.useState)(null),{showAlert:R}=(0,T.M)(),E=(0,r.useCallback)(async()=>{j(!0);try{let e=await fetch("/api/tasks/list?folderId=".concat(n)),t=await e.json();e.ok&&p(t.tasks||[])}catch(e){console.error("Error fetching tasks:",e)}finally{j(!1)}},[n]),O=(0,r.useCallback)(async()=>{try{let e=await fetch("/api/admins/list"),t=await e.json();e.ok&&f(t.admins||[])}catch(e){console.error("Error fetching admins:",e)}},[]);(0,r.useEffect)(()=>{t&&(E(),O())},[t,E,O]);let U=e=>e.assigned_to_everyone?"Everyone":g.filter(t=>e.assigned_to_admins.includes(t.id)).map(e=>e.full_name||e.email).join(", ")||"Unassigned",z=async e=>{w(e.id);try{(await fetch("/api/tasks/update-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:e.id,newStatus:"completed"})})).ok&&(E(),R({type:"success",title:"Task Complete.",message:"Task successfully updated to complete."}),x.refresh())}catch(e){console.error("Error updating task:",e),R({type:"error",title:"Task Error.",message:"Error updating task: ".concat(e)})}finally{w(null)}},J=async e=>{L(e.id);try{let t=await fetch("/api/tasks/revision-checking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:e.id})}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to submit revision");R({type:"success",title:"Revision Submitted",message:"Your revised task has been resubmitted for checking."}),E(),x.refresh()}catch(e){R({type:"error",title:"Submission Failed",message:e.message})}finally{L(null)}},B=async()=>{if(C){F(!0);try{(await fetch("/api/tasks/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({taskId:C.id})})).ok?(E(),R({type:"success",title:"Task Deleted.",message:"Task deleted successfully."}),x.refresh()):R({type:"error",title:"Delete Failed.",message:"Could not delete the task."})}catch(e){console.error("Error deleting task:",e),R({type:"error",title:"Delete Failed.",message:"Error deleting task: ".concat(e)})}finally{F(!1),S(null)}}},q=!c;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(P.Cf,{className:"w-[90vw] max-w-6xl h-[85vh] overflow-y-auto bg-white dark:bg-gray-950 rounded-xl shadow-lg flex flex-col gap-4 z-9999999",children:[(0,a.jsxs)(P.c7,{children:[(0,a.jsxs)(P.L3,{className:"text-2xl tracking-wide text-gray-950 dark:text-white",children:["Tasks for: ",o]}),(0,a.jsx)(P.rr,{className:"text-md tracking-wide text-gray-600 dark:text-white",children:"Manage tasks and action items for this folder"})]}),q&&(0,a.jsx)("div",{className:"mb-4 flex justify-end items-center px-8",children:(0,a.jsxs)(M.A,{onClick:()=>N(!0),children:[(0,a.jsx)(X.A,{className:"h-4 w-4 mr-2"}),"Create Task"]})}),y?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(H.A,{className:"h-8 w-8 animate-spin text-primary"})}):0===h.length?(0,a.jsx)("div",{className:"text-center py-8 text-muted-foreground text-gray-600 dark:text-white",children:"No tasks found for this folder"}):(0,a.jsx)("div",{className:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-white/5 dark:bg-white/3",children:(0,a.jsx)("div",{className:"max-w-full overflow-x-auto",children:(0,a.jsx)("div",{className:"min-w-[1000px]",children:(0,a.jsxs)(G.XI,{children:[(0,a.jsx)(G.A0,{className:"border-b border-gray-100 dark:border-white/5",children:(0,a.jsxs)(G.Hj,{children:[(0,a.jsx)(G.nA,{className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Title"}),(0,a.jsx)(G.nA,{className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Description"}),(0,a.jsx)(G.nA,{className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Assigned To"}),(0,a.jsx)(G.nA,{className:"px-5 py-3 font-medium text-gray-500 text-start text-theme-xs dark:text-gray-400",children:"Status"}),(0,a.jsx)(G.nA,{className:"px-5 py-3 font-medium text-gray-500 text-center text-theme-xs dark:text-gray-400",children:"Actions"})]})}),(0,a.jsx)(G.BF,{className:"divide-y divide-gray-100 dark:divide-white/5",children:h.map(e=>(0,a.jsxs)(G.Hj,{children:[(0,a.jsx)(G.nA,{className:"px-5 py-4 text-start font-medium text-gray-800 dark:text-white/90",children:e.title}),(0,a.jsx)(G.nA,{className:"px-5 py-4 text-start text-gray-500 text-theme-sm dark:text-gray-400",children:e.description||"—"}),(0,a.jsx)(G.nA,{className:"px-5 py-4 text-start text-gray-500 text-theme-sm dark:text-gray-400",children:U(e)}),(0,a.jsx)(G.nA,{className:"px-5 py-4 text-start text-theme-sm",children:(0,a.jsx)(D.A,{children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),(0,a.jsx)(G.nA,{className:"px-5 py-4 text-center text-gray-500 text-theme-sm dark:text-gray-400",children:(0,a.jsxs)(d.rI,{children:[(0,a.jsx)(d.ty,{asChild:!0,children:(0,a.jsx)(I.$,{variant:"ghost",size:"icon",children:(0,a.jsx)(m.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(d.SQ,{align:"end",className:"z-9999999 relative",children:["pending"===e.status&&(0,a.jsxs)(d._2,{onClick:()=>z(e),disabled:v===e.id,children:[v===e.id?(0,a.jsx)(H.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Mark as Completed"]}),"revision"===e.status&&(0,a.jsxs)(d._2,{onClick:()=>J(e),disabled:_===e.id,children:[_===e.id?(0,a.jsx)(H.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(V.A,{className:"h-4 w-4 mr-2"}),"Submit Revision"]}),q&&(0,a.jsxs)(d._2,{onClick:()=>S(e),className:"text-destructive",children:[(0,a.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})})]},e.id))})]})})})})]})}),(0,a.jsx)(et,{isOpen:!!C,onClose:()=>S(null),onConfirm:B,isLoading:A}),(0,a.jsx)(ee,{isOpen:b,onClose:()=>N(!1),folderId:n,dimensionId:i,onSuccess:()=>{E(),x.refresh()}})]})}var ea=s(9805),er=s(8033),el=s(8277),en=s(6187);function ei(e){let{isOpen:t,onClose:s,folder:r}=e;return r?(0,a.jsxs)(el.a,{isOpen:t,onClose:s,className:"max-w-[700px] py-12 px-20",children:[(0,a.jsxs)("div",{className:"w-full flex flex-col justify-start",children:[(0,a.jsx)("h4",{className:"mb-1 text-2xl font-semibold text-gray-800 dark:text-white/90",children:"Folder Information"}),(0,a.jsxs)("p",{className:"mb-4 text-sm text-gray-500 dark:text-gray-400",children:["See information for the folder ",r.name,"."]})]}),(0,a.jsxs)("div",{className:"space-y-4 mt-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Name"}),(0,a.jsx)("p",{className:"text-gray-900 dark:text-gray-100",children:r.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Status"}),(0,a.jsx)(D.A,{className:"draft"===r.status?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-white":"for_checking"===r.status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-white":"checked"===r.status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-white":"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-white",children:r.status.charAt(0).toUpperCase()+r.status.slice(1).replace("_"," ")})]}),r.dimension_id&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Dimension ID"}),(0,a.jsx)("p",{className:"text-gray-900 dark:text-gray-100",children:r.dimension_id})]}),r.description&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Description"}),(0,a.jsx)("p",{className:"text-gray-900 dark:text-gray-100",children:r.description})]}),r.is_locked&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Lock Status"}),(0,a.jsx)("p",{className:"text-gray-900 dark:text-gray-100",children:r.is_locked?"\uD83D\uDD12 Locked":"\uD83D\uDD13 Unlocked"})]}),r.created_at&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Created"}),(0,a.jsx)("p",{className:"text-gray-900 dark:text-gray-100",children:(0,en.GP)(new Date(r.created_at),"PPP p")})]}),r.updated_at&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Last Updated"}),(0,a.jsx)("p",{className:"text-gray-900 dark:text-gray-100",children:(0,en.GP)(new Date(r.updated_at),"PPP p")})]})]})]}):null}function eo(e){let{folders:t,dimensionSlug:s,dimensionId:n,isSharedView:I=!1,currentAdminRole:P}=e,F=(0,l.useRouter)(),{isMasterAdmin:_,isDimensionLeader:T,isDimensionMember:R,assignedDimensionId:E}=(0,v.A)(),[M,U]=(0,r.useState)(null),[z,B]=(0,r.useState)(null),[q,G]=(0,r.useState)(null),[X,H]=(0,r.useState)(null),[V,W]=(0,r.useState)(null),[Y,Q]=(0,r.useState)(!1),[K,ee]=(0,r.useState)(null),[et,el]=(0,r.useState)(new Set),{addDownload:en,updateDownload:eo}=(0,S.m)(),{moveItem:ed,setMoveItem:ec}=(0,A.a)(),[em,ex]=(0,r.useState)(!1),eh=5===P,[eu,ep]=(0,r.useState)(null),[eg,ef]=(0,r.useState)(null),[ey,ej]=(0,r.useState)(null),[eb,ek]=(0,r.useState)(new Set),[eN,ev]=(0,r.useState)(null),[ew,eC]=(0,r.useState)({}),[eS,eA]=(0,r.useState)(!1),[eI,eP]=(0,r.useState)(null),[eF,e_]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{for(let e of t){let t=localStorage.getItem("folder-token-".concat(e.id));if(t)try{let s=await fetch("/api/folders/verify-unlock-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderId:e.id,token:t})}),a=await s.json();s.ok&&a.success?ek(t=>new Set([...t,e.id])):localStorage.removeItem("folder-token-".concat(e.id))}catch(e){console.error("Error verifying unlock token:",e)}}})()},[t]);let eT=(0,r.useCallback)(async()=>{eA(!0);try{let e={};for(let s of t){let t=await fetch("/api/tasks/incomplete-count?folderId=".concat(s.id));if(t.ok){let a=await t.json();e[s.id]=a.incompleteCount||0}}eC(e)}catch(e){console.error("Error loading task counts:",e)}finally{eA(!1)}},[t]);(0,r.useEffect)(()=>{t.length>0&&eT()},[t,eT]);let eL=async(e,t)=>{t.preventDefault(),t.stopPropagation(),Q(!0),B(e);try{let t=await fetch("/api/folders/nested-counts?folderId=".concat(e.id));if(!t.ok)throw Error("Failed to fetch nested counts");let s=await t.json();W(s)}catch(e){console.error("Error fetching nested counts:",e),W({folders:0,files:0})}finally{Q(!1)}},eR=async e=>{let t=en({name:"".concat(e.name,".zip"),type:"folder"});try{var s;eo(t,{status:"downloading",progress:5});let a=await fetch("/api/folders/download?folderId=".concat(e.id,"&dimensionId=").concat(n));if(!a.ok)throw Error("Failed to download folder");eo(t,{progress:30});let r=a.headers.get("content-length"),l=r?Number.parseInt(r,10):0,i=0,o=null==(s=a.body)?void 0:s.getReader(),d=[];if(o)for(;;){let{done:e,value:s}=await o.read();if(e)break;if(d.push(s),i+=s.length,l>0){let e=Math.min(30+i/l*60,90);eo(t,{progress:e})}}eo(t,{progress:95});let c=new Blob(d,{type:"application/zip"}),m=URL.createObjectURL(c),x=document.createElement("a");x.href=m,x.download="".concat(e.name,".zip"),document.body.appendChild(x),x.click(),URL.revokeObjectURL(m),document.body.removeChild(x),eo(t,{status:"completed",progress:100})}catch(e){console.error("Error downloading folder:",e),eo(t,{status:"error",error:e instanceof Error?e.message:"Download failed"})}},eE=e=>{ec({type:"folder",id:e.id,name:e.name,currentFolderId:e.parent_folder_id||null})},eO=async e=>{try{let t=await fetch("/api/folders/copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderId:e.id,targetParentFolderId:e.parent_folder_id||null,dimensionId:n})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to copy folder")}F.refresh()}catch(e){console.error("Error copying folder:",e),alert("Error copying folder: ".concat(e.message))}},eD=e=>{ep(e)},eM=e=>{ef(e)},eU=e=>{ej(e)},ez=e=>5!==P||!!E&&E===n&&5===P&&"draft"===e.status,eJ=e=>5===P&&"checked"===e.status;return(0,a.jsxs)(a.Fragment,{children:[0===t.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[(0,a.jsx)(w.default,{src:"/images/no-folder.svg",alt:"No folders",width:350,height:350,className:"mb-6"}),(0,a.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:"Current directory have no folders."}),(0,a.jsx)("p",{className:"text-gray-400 dark:text-gray-500",children:'Click the "Create Folder" button at the top right to add folder in the current directory.'})]}):(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:t.map(e=>(0,a.jsxs)(o.Zp,{className:"group relative border border-gray-200 bg-white dark:border-white/5 dark:bg-white/3 rounded-xl  transition-all duration-200 ease-out hover:shadow-lg hover:border-primary/60 hover:-translate-y-1",children:[ew[e.id]>0&&(0,a.jsx)("span",{className:"absolute right-0 top-0.5 z-10 h-3 w-3 rounded-full bg-orange-400 flex",children:(0,a.jsx)("span",{className:"absolute inline-flex w-full h-full bg-orange-400 rounded-full opacity-75 animate-ping"})}),(0,a.jsxs)(o.Wu,{className:"p-0 relative",children:[e.is_locked&&(0,a.jsx)("div",{className:"absolute top-2 left-16 z-5",children:(0,a.jsx)("div",{className:"bg-red-100 border border-red-300 rounded-full p-1.5 flex items-center justify-center",children:(0,a.jsx)(c.A,{className:"h-3 w-3 text-red-600"})})}),(0,a.jsx)("div",{className:"absolute top-2 right-2 z-10",children:(0,a.jsxs)(d.rI,{open:eI===e.id,onOpenChange:t=>eP(t?e.id:null),children:[(0,a.jsx)(d.ty,{asChild:!0,onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("button",{className:"text-black dark:text-white flex h-7 w-7 items-center justify-center rounded-md opacity-0  group-hover:opacity-100 transition-opacity hover:bg-gray-200  dark:hover:bg-gray-400",children:[(0,a.jsx)(m.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Actions"})]})}),(0,a.jsxs)(d.SQ,{align:"end",className:"py-4 px-6",children:[(0,a.jsxs)(d._2,{onClick:t=>{t.preventDefault(),t.stopPropagation(),ev(e),eP(null)},className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(ea.ZM,{className:"h-4 w-4 mr-2"}),ew[e.id]>0&&(0,a.jsx)("span",{className:"absolute right-0 top-0.5 z-10 h-2 w-2 rounded-full bg-orange-400 flex",children:(0,a.jsx)("span",{className:"absolute inline-flex w-full h-full bg-orange-400 rounded-full opacity-75 animate-ping"})}),(0,a.jsx)("span",{children:"Tasks"})]}),(0,a.jsx)(d._2,{onClick:t=>{t.preventDefault(),t.stopPropagation(),eP(null),e.is_locked&&!eb.has(e.id)?eM(e):e.is_locked||eD(e)},disabled:e.is_locked&&eb.has(e.id),className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:e.is_locked?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),eb.has(e.id)?"Already Unlocked":"Unlock Folder"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Lock Folder"]})}),5!==P&&e.is_locked&&(0,a.jsxs)(d._2,{onClick:t=>{t.preventDefault(),t.stopPropagation(),eU(e),eP(null)},className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Reset PIN"]}),ez(e)&&(0,a.jsxs)(d._2,{onClick:t=>{t.preventDefault(),t.stopPropagation(),G(e),eP(null)},className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Change Status"]}),eJ(e)&&(0,a.jsxs)(d._2,{onClick:t=>{t.preventDefault(),t.stopPropagation(),H(e),eP(null)},className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Request Revision"]}),(5===P&&"draft"===e.status||5!==P)&&(0,a.jsxs)(d._2,{onClick:t=>{t.preventDefault(),t.stopPropagation(),eP(null),ee(e)},className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Share Access"]}),(0,a.jsx)(d.mB,{className:"my-2 border-t border-gray-300 dark:border-gray-700"}),(0,a.jsxs)(d._2,{onClick:t=>{t.preventDefault(),t.stopPropagation(),e_(e),eP(null)},className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Folder Information"]}),(0,a.jsx)(d.mB,{className:"my-2 border-t border-gray-300 dark:border-gray-700"}),(0,a.jsxs)(d._2,{onClick:t=>{t.preventDefault(),t.stopPropagation(),eP(null),eR(e)},className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",disabled:et.has(e.id),children:[(0,a.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Download"]}),(5===P&&("draft"===e.status||"revisions"===e.status)||5!==P)&&(0,a.jsxs)(d._2,{onClick:t=>{t.preventDefault(),t.stopPropagation(),U(e),eP(null)},className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Rename"]}),(5===P&&"draft"===e.status||5!==P)&&(0,a.jsxs)(d._2,{onClick:t=>{t.preventDefault(),t.stopPropagation(),eO(e),eP(null)},className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Make a copy"]}),(5===P&&("draft"===e.status||"revisions"===e.status)||5!==P)&&(0,a.jsxs)(d._2,{onClick:t=>{t.preventDefault(),t.stopPropagation(),eP(null),eE(e)},className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Move"]}),(5===P&&"draft"===e.status||5!==P)&&(0,a.jsxs)(d._2,{onClick:t=>{t.preventDefault(),t.stopPropagation(),eP(null),eL(e,t)},className:"relative transition-colors duration-150 ease-in-out hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md cursor-pointer",children:[(0,a.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})}),(0,a.jsxs)(i(),{href:e.is_locked&&!eb.has(e.id)?"#":"/dashboard/".concat(s,"/").concat(e.id),onClick:t=>{e.is_locked&&!eb.has(e.id)&&(t.preventDefault(),t.stopPropagation(),eM(e))},className:"block py-6 px-6 h-full rounded-xl transition-colors duration-200 hover:bg-gray-100 dark:hover:bg-gray-800/60",children:[(0,a.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-center w-12 h-12 rounded-xl  bg-gray-100 dark:bg-gray-600  transition-transform duration-200 group-hover:scale-105",children:(0,a.jsx)(w.default,{width:50,height:40,src:"/images/icons/folder.svg",className:"h-[30px] w-[30px]",alt:"folder"})}),(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsx)("div",{children:(0,a.jsx)("h3",{className:"text-sm text-start text-gray-800 dark:text-gray-200",children:e.name})})})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(D.A,{className:"draft"===e.status?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-white":"for_checking"===e.status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-white":"checked"===e.status?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-white":"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-white",children:"for_checking"===e.status?"For Checking":e.status.charAt(0).toUpperCase()+e.status.slice(1)})})]})]})]},e.id))}),M&&(0,a.jsx)(er.A,{isOpen:!!M,onClose:()=>U(null),itemType:"folder",itemId:M.id,currentName:M.name,onSuccess:()=>{F.refresh()}}),z&&(0,a.jsx)(N.A,{isOpen:!!z,onClose:()=>{B(null),W(null)},itemType:"folder",itemId:z.id,itemName:z.name,nestedCounts:V||void 0,onSuccess:()=>{F.refresh()}}),K&&(0,a.jsx)(C.Z,{isOpen:!!K,onClose:()=>ee(null),itemType:"folder",itemId:K.id,itemName:K.name,currentDimensionId:K.dimension_id,onSuccess:()=>{F.refresh()}}),q&&(0,a.jsx)(O,{isOpen:!!q,onClose:()=>G(null),folderId:q.id,currentStatus:q.status,folderName:q.name,isDimensionLeader:T,isDimensionMember:eh,onSuccess:()=>{F.refresh()}}),X&&(0,a.jsx)(L,{isOpen:!!X,onClose:()=>H(null),itemType:"folder",itemId:X.id,itemName:X.name,dimensionId:n||0,onSuccess:()=>{F.refresh()}}),eu&&(0,a.jsx)($,{isOpen:!!eu,onClose:()=>ep(null),folderId:eu.id,folderName:eu.name,onSuccess:()=>{ep(null)}}),eg&&(0,a.jsx)(Z,{isOpen:!!eg,onClose:()=>ef(null),folderId:eg.id,folderName:eg.name,onSuccess:e=>{localStorage.setItem("folder-token-".concat(eg.id),e),ek(e=>new Set([...e,eg.id])),ef(null)}}),ey&&(0,a.jsx)(J,{isOpen:!!ey,onClose:()=>ej(null),folderId:ey.id,folderName:ey.name,onSuccess:()=>{ej(null)}}),eN&&(0,a.jsx)(es,{isOpen:!!eN,onClose:()=>ev(null),folderId:eN.id,dimensionId:n||0,folderName:eN.name,isDimensionMember:eh}),eF&&(0,a.jsx)(ei,{isOpen:!!eF,onClose:()=>e_(null),folder:eF})]})}var ed=s(9049),ec=s(858),em=s(4416),ex=s(1492);function eh(e){let{folders:t,files:s,currentUserId:n,dimensionId:i,dimensionSlug:o,currentFolderId:d,currentlyFolder:c,isSharedView:m=!1,currentAdminRole:x,hasAccessToThisDimension:h=!1}=e,u=(0,l.useRouter)(),[p,g]=(0,r.useState)(!1),[f,y]=(0,r.useState)(!1),[j,b]=(0,r.useState)(""),[k,N]=(0,r.useState)({field:"name",order:"asc"}),v=(0,r.useMemo)(()=>j.trim()?t.filter(e=>e.name.toLowerCase().includes(j.toLowerCase())):t,[t,j]),w=(0,r.useMemo)(()=>{let e=[...v];return"name"===k.field?e.sort((e,t)=>e.name.localeCompare(t.name)):"date"===k.field&&e.sort((e,t)=>new Date(e.updated_at).getTime()-new Date(t.updated_at).getTime()),"desc"===k.order&&e.reverse(),e},[v,k]),{moveItem:C,setMoveItem:S}=(0,A.a)(),[I,P]=(0,r.useState)(!1),F=(null==c?void 0:c.status)||"draft",_=async()=>{if(C&&"folder"===C.type){P(!0);try{let e=await fetch("/api/folders/move",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({folderId:C.id,targetParentFolderId:d||null})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to move folder")}S(null),u.refresh()}catch(e){console.error("Error moving folder:",e),alert("Error moving folder: ".concat(e.message))}finally{P(!1)}}};return(0,a.jsxs)("div",{className:"space-y-6",children:[C&&(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg p-4 flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("span",{className:"text-sm font-medium",children:["Moving ",C.type,": ",(0,a.jsx)("span",{className:"font-semibold",children:C.name})]})}),(0,a.jsx)(M.A,{onClick:()=>S(null),className:"h-6 w-6 p-0 flex items-center justify-center",children:(0,a.jsx)(em.A,{className:"h-4 w-4 text-gray-700 dark:text-white"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("div",{className:"relative flex flex-row gap-4 mb-8 items-center justify-end",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute -translate-y-1/2 left-4 top-1/2 pointer-events-none",children:(0,a.jsx)("svg",{className:"fill-gray-500 dark:fill-gray-400",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.04175 9.37363C3.04175 5.87693 5.87711 3.04199 9.37508 3.04199C12.8731 3.04199 15.7084 5.87693 15.7084 9.37363C15.7084 12.8703 12.8731 15.7053 9.37508 15.7053C5.87711 15.7053 3.04175 12.8703 3.04175 9.37363ZM9.37508 1.54199C5.04902 1.54199 1.54175 5.04817 1.54175 9.37363C1.54175 13.6991 5.04902 17.2053 9.37508 17.2053C11.2674 17.2053 13.003 16.5344 14.357 15.4176L17.177 18.238C17.4699 18.5309 17.9448 18.5309 18.2377 18.238C18.5306 17.9451 18.5306 17.4703 18.2377 17.1774L15.418 14.3573C16.5365 13.0033 17.2084 11.2669 17.2084 9.37363C17.2084 5.04817 13.7011 1.54199 9.37508 1.54199Z",fill:""})})}),(0,a.jsx)("input",{type:"search",placeholder:"Search folders...",value:j,onChange:e=>b(e.target.value),className:"dark:bg-dark-900 h-11 w-full rounded-lg border border-gray-200 bg-transparent py-2.5 pl-12 pr-14 text-sm text-gray-800 shadow-theme-xs placeholder:text-gray-400 focus:border-brand-300 focus:outline-hidden focus:ring-3 focus:ring-brand-500/10 dark:border-white dark:bg-gray-900 dark:text-white/90 dark:placeholder:text-white/30 dark:focus:border-brand-800 xl:w-[430px]"})]}),(0,a.jsxs)(M.A,{variant:"outline",onClick:()=>y(!0),className:"flex items-center gap-1",children:[(0,a.jsx)(ex.A,{className:"h-4 w-4 mr-1"}),"Sort"]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-medium text-black dark:text-white",children:"Folders"}),(h&&5===x&&("draft"===F||"revisions"===F)||h&&5!==x)&&(0,a.jsxs)("div",{className:"flex gap-4",children:[C&&"folder"===C.type&&(0,a.jsx)(M.A,{onClick:_,disabled:I,size:"sm",children:I?"Moving...":"Move here"}),(0,a.jsx)(ed.V,{dimensionId:i,parentFolderId:d,createdBy:n})]})]})]}),(0,a.jsx)(eo,{folders:w,dimensionSlug:o,dimensionId:i,isSharedView:m,currentAdminRole:x})]}),(0,a.jsx)(ec.X,{isOpen:f,onClose:()=>y(!1),options:k,onSort:N,title:"Sort Folders",availableFields:["name","date"]})]})}},7642:(e,t,s)=>{Promise.resolve().then(s.bind(s,6112)),Promise.resolve().then(s.bind(s,6733)),Promise.resolve().then(s.bind(s,2623))},9409:(e,t,s)=>{"use strict";s.d(t,{bq:()=>x,eb:()=>g,gC:()=>p,l6:()=>c,yv:()=>m});var a=s(5155),r=s(2115),l=s(8893),n=s(6474),i=s(7863),o=s(5196),d=s(6707);let c=l.bL;l.YJ;let m=l.WT,x=r.forwardRef((e,t)=>{let{className:s,children:r,...i}=e;return(0,a.jsxs)(l.l9,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...i,children:[r,(0,a.jsx)(l.In,{asChild:!0,children:(0,a.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});x.displayName=l.l9.displayName;let h=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})});h.displayName=l.PP.displayName;let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(n.A,{className:"h-4 w-4"})})});u.displayName=l.wn.displayName;let p=r.forwardRef((e,t)=>{let{className:s,children:r,position:n="popper",...i}=e;return(0,a.jsx)(l.ZL,{children:(0,a.jsxs)(l.UC,{ref:t,className:(0,d.cn)("relative z-999999999 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...i,children:[(0,a.jsx)(h,{}),(0,a.jsx)(l.LM,{className:(0,d.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(u,{})]})})});p.displayName=l.UC.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.JU,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...r})}).displayName=l.JU.displayName;let g=r.forwardRef((e,t)=>{let{className:s,children:r,...n}=e;return(0,a.jsxs)(l.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(l.VF,{children:(0,a.jsx)(o.A,{className:"h-4 w-4"})})}),(0,a.jsx)(l.p4,{children:r})]})});g.displayName=l.q7.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",s),...r})}).displayName=l.wv.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[9688,1537,4203,9535,3063,5933,5452,6874,6682,5502,4225,6727,4046,356,7619,4443,8441,1684,7358],()=>t(7642)),_N_E=e.O()}]);